---
// src/sections/Hero.astro
import { Image } from 'astro:assets';

// IMPORTAMOS LAS IMÁGENES
import bgCuzco from '../assets/hero/background-cuzco.webp';
import bgAmazonas from '../assets/hero/amazonas_river.webp';
import bgArequipa from '../assets/hero/arequipa_city.webp';
import bgHuacachina from '../assets/hero/huacachina_oasis.webp';
import bgPuno from '../assets/hero/puno_lake.webp';

const slides = [
  { img: bgCuzco, alt: "Machu Picchu y Cusco Mágico" },
  { img: bgAmazonas, alt: "Río Amazonas y Selva Peruana" },
  { img: bgArequipa, alt: "Ciudad Blanca de Arequipa y Volcán Misti" },
  { img: bgHuacachina, alt: "Oasis de la Huacachina en Ica" },
  { img: bgPuno, alt: "Lago Titicaca y Uros en Puno" },
];
---

<section class="relative w-full min-h-[100svh] flex items-center justify-center overflow-hidden bg-[#1a1a1a] font-sans">
  
  <div class="absolute inset-0 z-0">
    {slides.map((slide, index) => (
      <Image 
        src={slide.img}
        alt={slide.alt}
        widths={[640, 1024, 1920]}
        sizes="100vw"
        quality={80} 
        format="avif"
        loading={index === 0 ? "eager" : "lazy"} 
        class={`hero-bg absolute inset-0 w-full h-full object-cover object-center animate-zoom-slow transition-opacity duration-[2000ms] ease-in-out ${index === 0 ? 'opacity-100 z-10' : 'opacity-0 z-0'}`}
      />
    ))}
    <div class="absolute inset-0 bg-gradient-to-t from-[#1a1a1a] via-[#1a1a1a]/40 to-[#1a1a1a]/30 z-20"></div>
  </div>

  <div class="relative z-30 w-full max-w-7xl mx-auto px-4 sm:px-6 flex flex-col items-center justify-start md:justify-center h-full pt-44 md:pt-20 pb-24 md:pb-10">
    
    <div class="animate-fade-in-down mb-3 md:mb-6">
      <span class="inline-flex items-center gap-2 px-3 py-1.5 md:px-4 md:py-2 rounded-full bg-white/10 backdrop-blur-md border border-white/20 text-white text-[10px] md:text-sm font-medium tracking-wide shadow-lg">
        <span class="flex h-1.5 w-1.5 md:h-2 md:w-2 rounded-full bg-[#25D366] animate-pulse"></span>
        Agencia de Viajes Certificada
      </span>
    </div>

    <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold text-white leading-[1.1] tracking-tight mb-3 md:mb-6 text-center animate-fade-in-up">
      Descubre lo <br class="sm:hidden" />
      <span class="text-transparent bg-clip-text bg-gradient-to-r from-[#AE333C] via-[#FF9A09] to-[#AE333C] bg-300% animate-gradient">
        Inolvidable
      </span>
    </h1>

    <p class="text-gray-100 text-sm sm:text-lg md:text-xl font-light max-w-xl md:max-w-3xl mb-6 md:mb-10 text-center animate-fade-in-up delay-100 leading-relaxed drop-shadow-md px-4">
      Expertos en conectar tus sueños con destinos reales. Tours exclusivos en Arequipa, Cusco y todo el Perú.
    </p>

    <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 w-full sm:w-auto animate-fade-in-up delay-200 px-4 sm:px-0 mb-6 md:mb-12">
      <a 
        href="https://wa.me/51953530209?text=Hola" 
        target="_blank"
        rel="noopener noreferrer"
        class="group relative px-6 py-3 md:px-8 md:py-4 rounded-full bg-gradient-to-r from-[#AE333C] to-[#FF9A09] text-white font-bold text-base md:text-lg shadow-lg active:scale-[0.98] transition-all flex items-center justify-center overflow-hidden"
      >
        <span class="relative z-10">Cotizar mi Viaje</span>
        <div class="absolute inset-0 h-full w-full bg-white/20 scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-500"></div>
      </a>

      <a 
        href="#paquetes" 
        class="px-6 py-3 md:px-8 md:py-4 rounded-full border border-white/30 bg-white/5 backdrop-blur-sm text-white font-semibold text-base md:text-lg hover:bg-white/10 transition-all flex items-center justify-center"
      >
        Ver Destinos
      </a>
    </div>

    <div class="mt-auto md:mt-0 grid grid-cols-3 gap-6 md:gap-16 border-t border-white/10 pt-4 md:pt-8 w-full max-w-4xl animate-fade-in animate-delay-500">
        <div class="text-center">
            <p class="text-2xl md:text-4xl font-bold text-white drop-shadow-lg">
              <span class="counter" data-target="10" data-prefix="+">0</span>
            </p>
            <p class="text-[10px] md:text-sm text-gray-300 uppercase tracking-widest font-semibold mt-1">Años Exp.</p>
        </div>
        <div class="text-center">
            <p class="text-2xl md:text-4xl font-bold text-white drop-shadow-lg">
              <span class="counter" data-target="100" data-suffix="%">0</span>
            </p>
            <p class="text-[10px] md:text-sm text-gray-300 uppercase tracking-widest font-semibold mt-1">Garantía</p>
        </div>
        <div class="text-center">
            <p class="text-2xl md:text-4xl font-bold text-white drop-shadow-lg">
              <span class="counter" data-target="24" data-suffix="/7">0</span>
            </p>
            <p class="text-[10px] md:text-sm text-gray-300 uppercase tracking-widest font-semibold mt-1">Soporte</p>
        </div>
    </div>

  </div>
</section>

<script>
  const images = document.querySelectorAll('.hero-bg');
  let currentIndex = 0;
  const intervalTime = 5000;

  if (images.length > 0) {
    setInterval(() => {
      images[currentIndex].classList.remove('opacity-100', 'z-10');
      images[currentIndex].classList.add('opacity-0', 'z-0');
      currentIndex = (currentIndex + 1) % images.length;
      images[currentIndex].classList.remove('opacity-0', 'z-0');
      images[currentIndex].classList.add('opacity-100', 'z-10');
    }, intervalTime);
  }

  const counters = document.querySelectorAll('.counter');
  const speed = 200;

  const animateCounter = (counter:Element) => {
    const target = parseInt(counter.getAttribute('data-target') || '0');
    const prefix = counter.getAttribute('data-prefix') || '';
    const suffix = counter.getAttribute('data-suffix') || '';
    let count = 0;
    const increment = target / speed;

    const updateCount = () => {
      count += increment;
      if (count < target) {
        counter.textContent = prefix + Math.ceil(count) + suffix;
        requestAnimationFrame(updateCount);
      } else {
        counter.textContent = prefix + target + suffix;
      }
    };
    updateCount();
  };

  const counterObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        animateCounter(entry.target);
        counterObserver.unobserve(entry.target);
      }
    });
  }, { threshold: 0.5 });

  counters.forEach(counter => counterObserver.observe(counter));
</script>

<style>
  .bg-300% { background-size: 300% auto; }
  @keyframes gradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  .animate-gradient { animation: gradient 6s ease infinite; }
  
  @keyframes zoom-slow {
    0% { transform: scale(1); }
    100% { transform: scale(1.1); }
  }
  .animate-zoom-slow { animation: zoom-slow 20s linear infinite alternate; }
  
  @media (max-width: 640px) {
    .animate-zoom-slow { animation: zoom-slow 25s linear infinite alternate; }
  }
</style>